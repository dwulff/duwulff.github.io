}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
g = graph_from_data_frame(tab[,1:2],directed=F)
v = get.vertex.attribute(g)$name
l = layout_with_fr(g)
col1 = rgb(224,238,212,maxColorValue = 255)
col2 = rgb(220,207,232,maxColorValue = 255)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
?assortativity
assortivity(g,gens)
assortativity_nominal(g,gens)
gens
get.vertex.attribute(g)$name
length(get.vertex.attribute(g)$name)
length(gens)
assortativity_nominal(g,gens,directed=F)
assortativity_nominal(g,gens=='w',directed=F)
assortativity_nominal(g,as.numeric(gens=='w'),directed=F)
as.numeric(gens=='w')
g
assortativity_nominal(g,as.numeric(gens=='w')+1,directed=F)
as.numeric(gens=='w')+1
average.path.length(g,)
average.path.length(g)
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]+.5,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3],lty=3,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3],lty=1,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]**1.5,lty=1,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]**2,lty=1,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.2-.2)
}
plot.new();plot.window(c(min(l[,1]),max(l[,1])),c(min(l[,2]),max(l[,2])))
sapply(1:nrow(tab),function(x){
is = c(which(v==tab[x,1]),which(v==tab[x,2]))
lines(c(l[is[1],1],l[is[2],1]),c(l[is[1],2],l[is[2],2]),lwd=tab[x,3]**2,lty=1,col='grey50')
})
for(i in 1:length(v)){
points(l[i,1]+.04,l[i,2]-.04,cex=cnt[v[i]]**.9,pch=16,col='grey50')
points(l[i,1],l[i,2],cex=cnt[v[i]]**.9,pch=16,col=ifelse(gens[i]=='w',col2,col1))
}
for(i in 1:length(v)){
text(l[i,1],l[i,2],labels=v[i],cex=cnt[v[i]]**.1-.2)
}
tab
#### risk net
options(stringsAsFactors = F)
require(googlesheets)
gs = gs_title('The psycho network')
d = gs_read(gs)
d = data.frame(d)
gs2 = gs_title('psychnet gender')
gen = gs_read(gs2,1,col_names=F)
gen = data.frame(d2)
ano = gs_read(gs2,2,col_names=F)
ano = data.frame(d3)
mal = unique(ano[ano[,2]=='m',1])
fem = unique(ano[ano[,2]=='w',1])
gen$ano = NA
gen$ano[gen[,2]=='w'] = fem[1:sum(gen[,2]=='w')]
gen$ano[gen[,2]=='m'] = mal[1:sum(gen[,2]=='m')]
names(gen) = c('name','gender','anon')
d[,4]
actors = d[,4]
resp = d[,grepl('Vorname',names(d))]
resp[resp == 'Tehilla Mechera-Ostrovsky'] = 'Tehilla Mechera'
resp[resp == 'Julia van Ditzhuijzen'] = 'Julia von Duitzhuijzen'
resp[resp == 'Nikola Kaiser'] = 'Nicolà Kaiser'
resp[resp == 'Maximilian Kneer'] = 'Max Kneer'
resp[resp == 'Laura Babbi'] = 'Lara Babbi'
resp[resp == 'Britanny Ehemann'] = 'Brittany Ehemann'
resp[resp == 'Antonin Troendle'] = 'Antonin Tröndle'
resp[resp == 'Sebastian Naef'] = 'Sebastian Näf'
resp[resp == 'Babice van Waldenburg'] = 'Babice van Waardenburg'
resp[resp == 'Jonas Mummenthal'] = 'Jonas Mumenthaler'
resp[resp == 'Michael Vogt'] = 'Michel Vogt'
resp[resp == 'Leo Stahl'] = 'Leonard Stahl'
frq = table(unlist(resp))
frq[order(frq,decreasing=T)]
con = file('~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/randomnames.txt')
lin = readLines(con)
close(con)
for(i in 1:nrow(gen)){
actors[actors == gen$name[i]] = gen$anon[i]
resp[resp == gen$name[i]] = gen$anon[i]
}
edges = c()
for(i in 1:nrow(resp)){
actor = actors[i]
res = data.frame(actor,'response'=unlist(resp[i,!is.na(resp[i,])]))
res = data.frame(t(apply(res,1,function(x) x[order(x)])))
edges = rbind(edges,res)
}
rownames(edges) = NULL
tab
table(tab[,3])
head(tab)
head(cnt)
cnt
cnt
data = list(edg,cnt)
edg = tab
data = list(edg,cnt)
saveRDS('~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/Psychonet.RDS')
saveRDS(data,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/Psychonet.RDS')
data = list(edg,cnt,'gen'=gens)
saveRDS(data,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/Psychonet.RDS')
saveRDS(data,'~/Dropbox (2.0)/Work/Software/dwulff.github.io/_Networks/Downloads/Psychonet.RDS')
install.packages('digest')
require(digest)
read.aes
install.packages('repmis')
require(repmis)
?source_DropboxData
??Dropbox
tab
rownames(tab) = NULL
tab
rownames(edg) = NULL
edg
write.table(edg,'~/Dropbox (2.0)/Work/Software/dwulff.github.io/_Networks/Downloads/edg.txt')
write.table(edg,'~/Dropbox (2.0)/Work/Software/dwulff.github.io/_Networks/Downloads/edg.txt')
write.table(cnt,'~/Dropbox (2.0)/Work/Software/dwulff.github.io/_Networks/Downloads/cnt.txt')
write.table(gens,'~/Dropbox (2.0)/Work/Software/dwulff.github.io/_Networks/Downloads/gen.txt')
write.table(edg,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/edg.txt',quote)
write.table(cnt,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/Downloads/cnt.txt')
write.table(gens,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/Downloads/gen.txt')
write.table(edg,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/edg.txt')
write.table(cnt,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/Downloads/cnt.txt')
write.table(edg,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/edg.txt',row.names = F,quote=F)
write.table(cnt,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/cnt.txt',row.names = F,quote=F)
write.table(gens,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/gen.txt',row.names = F,quote=F)
write.table(edg,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/edg.txt',row.names = F,quote=F,sep='\t')
write.table(cnt,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/cnt.txt',row.names = F,quote=F,sep='\t')
write.table(gens,'~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/gen.txt',row.names = F,quote=F,sep='\t')
101000 / (42*52)
goodchoices = read.table('_Goodchoices/GoodchoicesSurveys.txt',header=F,sep='\n')[,1]
options(stringsAsFactors = F)
require(googlesheets)
setwd('~/Dropbox (2.0)/Work/Software/dwulff.github.io/')
goodchoices = read.table('_Goodchoices/GoodchoicesSurveys.txt',header=F,sep='\n')[,1]
goodchoices
tab = paste0(goodchoices[3],' (Antworten)')
gs = gs_title(tab)
d = gs_read(gs)
d = as.data.frame(d)
comp = unlist(d[,4:6])
crit = unlist(d[,7:9])
for(com in comp) cat(com,'\n\n')
for(cri in crit) cat(cri,'\n\n')
install.packages('sodium')
require(data_encrypt)
require(sodium)
?data_encrypt
data_encrypt('hallo welt', 'networksarecool',)
key <- sha256(charToRaw("networksarecool"))
key
data_encrypt('hallo welt', key)
iris
serialize(iris, NULL)
?serialize
tab
#### risk net
options(stringsAsFactors = F)
require(googlesheets)
gs = gs_title('The psycho network')
d = gs_read(gs)
d = data.frame(d)
gs2 = gs_title('psychnet gender')
gen = gs_read(gs2,1,col_names=F)
gen = data.frame(d2)
ano = gs_read(gs2,2,col_names=F)
ano = data.frame(d3)
mal = unique(ano[ano[,2]=='m',1])
fem = unique(ano[ano[,2]=='w',1])
gen$ano = NA
gen$ano[gen[,2]=='w'] = fem[1:sum(gen[,2]=='w')]
gen$ano[gen[,2]=='m'] = mal[1:sum(gen[,2]=='m')]
names(gen) = c('name','gender','anon')
d[,4]
actors = d[,4]
resp = d[,grepl('Vorname',names(d))]
resp[resp == 'Tehilla Mechera-Ostrovsky'] = 'Tehilla Mechera'
resp[resp == 'Julia van Ditzhuijzen'] = 'Julia von Duitzhuijzen'
resp[resp == 'Nikola Kaiser'] = 'Nicolà Kaiser'
resp[resp == 'Maximilian Kneer'] = 'Max Kneer'
resp[resp == 'Laura Babbi'] = 'Lara Babbi'
resp[resp == 'Britanny Ehemann'] = 'Brittany Ehemann'
resp[resp == 'Antonin Troendle'] = 'Antonin Tröndle'
resp[resp == 'Sebastian Naef'] = 'Sebastian Näf'
resp[resp == 'Babice van Waldenburg'] = 'Babice van Waardenburg'
resp[resp == 'Jonas Mummenthal'] = 'Jonas Mumenthaler'
resp[resp == 'Michael Vogt'] = 'Michel Vogt'
resp[resp == 'Leo Stahl'] = 'Leonard Stahl'
frq = table(unlist(resp))
frq[order(frq,decreasing=T)]
con = file('~/Dropbox (2.0)/Work/Teaching/2016 winter/Netzwerke in der Psychologie/randomnames.txt')
lin = readLines(con)
close(con)
for(i in 1:nrow(gen)){
actors[actors == gen$name[i]] = gen$anon[i]
resp[resp == gen$name[i]] = gen$anon[i]
}
edges = c()
for(i in 1:nrow(resp)){
actor = actors[i]
res = data.frame(actor,'response'=unlist(resp[i,!is.na(resp[i,])]))
res = data.frame(t(apply(res,1,function(x) x[order(x)])))
edges = rbind(edges,res)
}
rownames(edges) = NULL
tab = data.frame(table(edges))
tab[,1] = as.character(tab[,1])
tab[,2] = as.character(tab[,2])
tab = tab[tab[,3]>0,]
names(tab) = c('name_1','name_2','frq')
nams = unique(unlist(tab[,1:2]))
gens = NA
for(i in 1:length(nams)){
gens[i] = gen[gen[,3]==nams[i],2]
}
encrypt = function(x,password){
key    = sha256(charToRaw(password))
msg    = serialize(x,NULL)
cipher = data_encrypt(msg, key)
return(cipher)
}
encrypt = function(x,password){
key    = sha256(charToRaw(password))
msg    = serialize(x,NULL)
cipher = data_encrypt(msg, key)
return(cipher)
}
decrypt = function(x,password){
orig = data_decrypt(x,key)
}
decrypt(encrypt(tab,'networksarecool'),'networksarecool')
encrypt = function(x,password){
key    = sha256(charToRaw(password))
msg    = serialize(x,NULL)
cipher = data_encrypt(msg, key)
return(cipher)
}
decrypt = function(x,password){
orig = data_decrypt(x,key)
return(orig)
}
decrypt(encrypt(tab,'networksarecool'),'networksarecool')
?serialize
encrypt = function(x,password){
key    = sha256(charToRaw(password))
msg    = serialize(x,NULL)
cipher = data_encrypt(msg, key)
return(cipher)
}
decrypt = function(x,password){
orig = data_decrypt(x,key)
orig = unserialize(orig)
return(orig)
}
decrypt(encrypt(tab,'networksarecool'),'networksarecool')
a = encrypt(tab,'networksarecool')
mean(tab == decrypt(a,'networksarecool'))
